# AustralianElectricityMarkets.jl Project Rules

## Library Documentation
* Always refer to the PowerSystems.jl documentation for accurate schema definitions and modeling best practices: https://nrel-sienna.github.io/PowerSystems.jl/stable/

## Data Transformation Patterns
* **Macro Usage**: Use the `@chain` macro for multi-step data processing.
* **TidierDB vs DataFrames**: Use `TidierDB` macros (`@select`, `@filter`, `@inner_join`, etc.) for database-side operations (before `@collect`). Use `DataFrames.jl` for in-memory operations after `@collect`.

## Power System Topology
* **Regional Model**: Each AEMO region is modeled as a Load Bus (`_LOAD_BUS`) and a Generator Bus (`_GEN_BUS`) connected to their respective components.
* **Per-Unitization**: Maintain system `BASE_POWER = 100.0` MVA. Ensure all power values (active/reactive power, ratings, limits) are correctly per-unitized.

## AEMO Mappings
* **Constants**: Refer to `src/constants.jl` for mappings of AEMO fuel types and technology labels to PowerSystems enums (e.g., `AEMO_PM_MAPPING`, `AEMO_FUEL_MAPPING`).
* **Generator Types**: Use `MATCH_TYPE_TO_PRIMEMOVER` in `src/network_models/region_model.jl` to determine the correct PowerSystems generator type (e.g., `HydroDispatch`, `ThermalStandard`, `RenewableDispatch`) based on prime mover codes.

## Data Quality
* **Versioning**: When querying AEMO tables, use the `_filter_latest` helper to handle `archive_month` and `VERSIONNO` logic, ensuring only the most recent records are processed.
